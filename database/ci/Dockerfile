FROM usgswma/iow_test_db:postgis10-11.0.3

LABEL maintainer=gs-w_eto_eb_federal_employees@usgs.gov

ARG DEFAULT_PASSWORD=changeMe
ARG DEFAULT_DATABASE_NAME=database_name
ARG DEFAULT_DATABASE_ADDRESS=127.0.0.1
ARG DEFAULT_DB_OWNER_USERNAME=db_owner
ARG DEFAULT_SCHEMA_OWNER_USERNAME=schema_owner
ARG DEFAULT_SCHEMA_NAME=schema_name

ARG POSTGRES_PASSWORD="${DEFAULT_PASSWORD}"
ENV POSTGRES_PASSWORD="${POSTGRES_PASSWORD}"

ARG AQTS_DATABASE_ADDRESS="${DEFAULT_DATABASE_ADDRESS}"
ENV AQTS_DATABASE_ADDRESS="${AQTS_DATABASE_ADDRESS}"
ARG AQTS_DATABASE_NAME="${DEFAULT_DATABASE_NAME}"
ENV AQTS_DATABASE_NAME="${AQTS_DATABASE_NAME}"
ARG AQTS_DB_OWNER_USERNAME="${DEFAULT_DB_OWNER_USERNAME}"
ENV AQTS_DB_OWNER_USERNAME="${AQTS_DB_OWNER_USERNAME}"
ARG AQTS_DB_OWNER_PASSWORD="${DEFAULT_PASSWORD}"
ENV AQTS_DB_OWNER_PASSWORD="${AQTS_DB_OWNER_PASSWORD}"
ARG AQTS_SCHEMA_NAME=${DEFAULT_SCHEMA_NAME}
ENV AQTS_SCHEMA_NAME="${AQTS_SCHEMA_NAME}"
ARG AQTS_SCHEMA_OWNER_USERNAME=${DEFAULT_SCHEMA_OWNER_USERNAME}
ENV AQTS_SCHEMA_OWNER_USERNAME="${AQTS_SCHEMA_OWNER_USERNAME}"
ARG AQTS_SCHEMA_OWNER_PASSWORD="${DEFAULT_PASSWORD}"
ENV AQTS_SCHEMA_OWNER_PASSWORD="${AQTS_SCHEMA_OWNER_PASSWORD}"

############################################
# Grab files for initializing the database
############################################

COPY ./liquibase/changeLogs $LIQUIBASE_WORKSPACE
COPY ./liquibase/scripts/*.sh /docker-entrypoint-initdb.d/
COPY ./liquibase/scripts/dbInit /docker-entrypoint-initdb.d/
